# ═══════════════════════════════════════════════════════════
# YOLOv11 Training Configuration - UniView Project  
# ═══════════════════════════════════════════════════════════

# ───────────────────────────────────────────────────────────
# DATASET
# ───────────────────────────────────────────────────────────
data: datasets/VisDrone/VisDrone.yaml

# ───────────────────────────────────────────────────────────
# MODEL
# ───────────────────────────────────────────────────────────
model:
  size: yolo11s                    # nano/small/medium/large/xlarge
  pretrained: models/pretrained/yolo11s.pt


# ───────────────────────────────────────────────────────────
# TRAINING - BASELINE
# ───────────────────────────────────────────────────────────
baseline:
  epochs: 10
  batch: 16
  imgsz: 640
  freeze: 10
  lr0: 0.001
  patience: 5


# ───────────────────────────────────────────────────────────
# TRAINING - FINAL
# ───────────────────────────────────────────────────────────
final:
  epochs: 100
  batch: 16
  imgsz: 640
  freeze: 10                       # יעודכן מOptuna
  lr0: 0.001                       # יעודכן מOptuna
  lrf: 0.01                        # יעודכן מOptuna
  patience: 20

# ───────────────────────────────────────────────────────────
# OPTUNA - HYPERPARAMETER SEARCH
# ───────────────────────────────────────────────────────────
optuna:
  n_trials: 3                      # כמה ניסויים
  epochs_per_trial: 30             # epochs לכל trial
  timeout: 72000                   # 20 hours max
  
  search_space:
    lr0: [0.00001, 0.01]          # learning rate range
    freeze: [0, 15]                # layers to freeze
    batch: [8, 16]                 # batch sizes (32 exceeds 8GB VRAM)
    lrf: [0.01, 0.1]              # final lr multiplier

# ───────────────────────────────────────────────────────────
# OPTIMIZER
# ───────────────────────────────────────────────────────────
optimizer:
  name: AdamW
  momentum: 0.937
  weight_decay: 0.0005

# ───────────────────────────────────────────────────────────
# AUGMENTATION
# ───────────────────────────────────────────────────────────
augmentation:
  hsv_h: 0.015                     # hue
  hsv_s: 0.7                       # saturation
  hsv_v: 0.4                       # value
  degrees: 0.0                     # rotation (0 for aerial!)
  translate: 0.1                   # translation
  scale: 0.5                       # scale
  shear: 0.0                       # shear
  perspective: 0.0                 # perspective
  flipud: 0.0                      # vertical flip (no for aerial!)
  fliplr: 0.5                      # horizontal flip
  mosaic: 1.0                      # mosaic augmentation
  mixup: 0.0                       # mixup


# ───────────────────────────────────────────────────────────
# HARDWARE
# ───────────────────────────────────────────────────────────
hardware:
  device: 0                        # GPU id, 'cpu', or [0,1,2,3]
  workers: 8                       # dataloader workers
  amp: true                        # automatic mixed precision

# ───────────────────────────────────────────────────────────
# OUTPUTS
# ───────────────────────────────────────────────────────────
outputs:
  project: runs                    # base output dir
  save_period: -1                  # save every N epochs (-1 = only best)
  plots: true                      # save plots
  verbose: true                    # print details


# ───────────────────────────────────────────────────────────
# EVALUATION
# ───────────────────────────────────────────────────────────
evaluation:
  conf_threshold: 0.25            # confidence threshold
  iou_threshold: 0.45             # NMS IOU threshold
  save_results: true              # save predictions
  save_plots: true                # save confusion matrix, etc.

# ───────────────────────────────────────────────────────────
# MLFlow
# ───────────────────────────────────────────────────────────

mlflow:
  enabled: true
  tracking_uri: http://localhost:5000
  experiment_name: yolov11-visdrone

# ───────────────────────────────────────────────────────────
# MISC
# ───────────────────────────────────────────────────────────
seed: 42                           # random seed
deterministic: false              # deterministic mode (slower)